<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="c0e5508c-3ca9-462c-a8b5-842087cdbe60" activeEnvironment="Default" name="Room Booking Project" resourceRoot="" soapui-version="5.7.2" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="fbdcf60d-7c11-4da6-85ed-ca40c6fe8993" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="Cities" path="/cities" id="67924f4a-9015-4ef2-b1b6-3154a280d494"><con:settings/><con:parameters/><con:method name="Cities 1" id="0b2ed0d1-eb98-4ed2-a9cb-08d1b222d47c" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="ceb334a8-4128-4328-9299-e11d023715e2" mediaType="application/json"><con:settings/><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="33e05a43-69f2-41ab-9f22-65881e14aa5b" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="Rooms" path="/rooms" id="ac121144-442d-4a25-ad20-384d45f06028"><con:settings/><con:parameters/><con:method name="Rooms 1" id="39f25e12-a164-4ba2-a0a4-c539e39fdb19" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="c1950295-8585-48b2-b731-3eb8872c72e8" mediaType="application/json"><con:settings/><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="29270c5d-68ba-46df-918b-26b45517f246" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="BookedRooms" path="/bookedRooms" id="2f6ba2de-5ad7-460d-a4c9-2b0ba1e4c93e"><con:settings/><con:parameters/><con:method name="BookedRooms 1" id="2c749195-428e-4808-801d-bf8d3d3d8dff" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="e01b62b0-8ef3-4deb-8852-8ab86a58e647" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/bookedRooms</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="966b8edb-049a-438e-982e-5ae8ba075d26" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="Users" path="/users" id="258cc8a1-4f35-48eb-a596-fb281e81f9d4"><con:settings/><con:parameters/><con:method name="Users 1" id="6bc8fa08-6c2a-4add-89de-d0f8b0240c0d" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="1a95aa5c-fc7d-45e2-9927-5eae36341fa3" mediaType="application/json"><con:settings/><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="4907804f-a907-4cd7-841d-bdeca20ab940" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="Admins" path="/admins" id="fefc9327-356b-48d1-ad48-3392bf4021d9"><con:settings/><con:parameters/><con:method name="Admins 1" id="4048f13f-af26-44e0-b111-e37505c34dea" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="1aa610da-7d9c-4ea8-8e04-5bdcba9b6af3" mediaType="application/json"><con:settings/><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="4f2f7cee-d1ea-4f5e-b3a1-ede18ab84794" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://localhost:8888" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://localhost:8888</con:endpoint></con:endpoints><con:resource name="Contact" path="/contact" id="30945cad-2b60-422e-8068-81acd02ebe42"><con:settings/><con:parameters/><con:method name="Contact 1" id="b6ca5b62-3756-4ae7-920a-ca373a825905" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element>Response</con:element></con:representation><con:request name="Request 1" id="afedcbc2-6d2d-4edb-8002-ba32d30d9b03" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/contact</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="8d42fba6-bf61-46d3-b033-8f66c62c653b" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="9e167793-22ef-4a0a-b712-4e39d6ecc085" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Room Booking API" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="Cities 1 - Request 1" id="a7644612-ad65-42b0-92c1-2ab1b2061966"><con:settings/><con:config service="http://localhost:8888" resourcePath="/cities" methodName="Cities 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Cities 1 - Request 1" id="ceb334a8-4128-4328-9299-e11d023715e2" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/cities</con:originalUri><con:assertion type="Simple Contains" id="def8f7f3-0d35-40ea-8681-07168ac7496e" name="Contains"><con:configuration><token>Chennai</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Rooms 1 - Request 1" id="10c744dc-abcf-435c-adb1-2c1a333fa7b9"><con:settings/><con:config service="http://localhost:8888" resourcePath="/rooms" methodName="Rooms 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Rooms 1 - Request 1" id="c1950295-8585-48b2-b731-3eb8872c72e8" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/rooms</con:originalUri><con:assertion type="Simple Contains" id="9a7ad189-056b-43bf-9e07-17e8d84ea841" name="Contains"><con:configuration><token>Mumbai</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="BookedRooms 1 - Request 1" id="c3ec28af-caf2-4c82-9286-baa07d7b99ff"><con:settings/><con:config service="http://localhost:8888" resourcePath="/bookedRooms" methodName="BookedRooms 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="BookedRooms 1 - Request 1" id="e01b62b0-8ef3-4deb-8852-8ab86a58e647" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/bookedRooms</con:originalUri><con:assertion type="Simple Contains" id="084c49f5-9e90-47d1-bf6d-59f5f99984e8" name="Contains"><con:configuration><token>booked</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Users 1 - Request 1" id="22245e39-bfe2-4f40-89d5-82370768d999"><con:settings/><con:config service="http://localhost:8888" resourcePath="/users" methodName="Users 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Users 1 - Request 1" id="1a95aa5c-fc7d-45e2-9927-5eae36341fa3" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/users</con:originalUri><con:assertion type="Simple Contains" id="0a3e3472-ea1b-4261-87ba-2cc04e3e0dbf" name="Contains"><con:configuration><token>user1</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Admins 1 - Request 1" id="a8be75b3-02c6-4111-8a30-d17f88a53297"><con:settings/><con:config service="http://localhost:8888" resourcePath="/admins" methodName="Admins 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Admins 1 - Request 1" id="1aa610da-7d9c-4ea8-8e04-5bdcba9b6af3" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/admins</con:originalUri><con:assertion type="Simple Contains" id="42001e0f-4383-44ed-9f3a-645bf0fa1e3e" name="Contains"><con:configuration><token>nirmal</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Contact 1 - Request 1" id="9ea5dcbd-95d9-4f36-9f7b-5a40c8423e7e"><con:settings/><con:config service="http://localhost:8888" resourcePath="/contact" methodName="Contact 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Contact 1 - Request 1" id="afedcbc2-6d2d-4edb-8002-ba32d30d9b03" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://localhost:8888</con:endpoint><con:request/><con:originalUri>http://localhost/contact</con:originalUri><con:assertion type="Simple Contains" id="ece1d17a-ced5-452e-9f24-cd8119d84bd1" name="Contains"><con:configuration><token>Nirmal Raj</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:tearDownScript>// Code to execute the GenerateCSVReport test step
testRunner.testCase.testSuite.project.testSuites["Library"].testCases["Reporting_Utility"].
testSteps["GenerateCSVReport"].run(testRunner, context);</con:tearDownScript><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="3c9364c3-f30a-4814-bb45-9f92a4045582" name="Library"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="5ecd55c2-e2cd-470a-b05f-b60d159a8f23" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Reporting_Utility" searchProperties="true"><con:settings/><con:testStep type="groovy" name="GenerateCSVReport" id="1e6b4a52-37e5-4751-b8d7-412daa5a01b1"><con:settings/><con:config><script>// Try-catch block to handle exceptions
try {

// 1. Create a "SoapUIResults" folder in the project path 
      // Retrieve the project root folder
      def projectPath = new com.eviware.soapui.support.GroovyUtils(context).projectPath

      // Specify a folder inside project root to store the results
      String folderPath = projectPath + "/SoapUIResults";

      // Create a File object for the specified path
      def resultFolder = new File(folderPath);

      // Check for existence of folder and create a folder
      if(!resultFolder.exists())
      {
        resultFolder.mkdirs();
      }

/* ------------------------------------------------------------------------------- */

// 2. Create a subfolder (with timestamp) to store the request-response local copy 
      // Retrieve the latest execution date-time
      Date d = new Date();
      def executionDate = d.format("dd-MMM-yyyy HH_mm");

      // Specify the subfolder path with name Request-Response_CurrentTimeStamp
      String subfolderPath1 = folderPath+ "/Request-Response_"+executionDate;

      // Create this sub-folder
      new File(subfolderPath1).mkdirs();

/* ------------------------------------------------------------------------------- */

// 3. Create another subfolder "CSV Reports" to store the reports file 
      // Specify the subfolder path with name CSV Reports
      String subfolderPath2 = folderPath+ "/CSV Reports";

      // Create this sub-folder
      new File(subfolderPath2).mkdirs();

/* ------------------------------------------------------------------------------- */

// 4. Create a Report.csv file inside the CSV Reports folder 
      // Create a File object for Report csv file (with timestamp)
      def reportFile = new File(subfolderPath2, "Report_"+executionDate+".csv");

      // Check for existence of report file and create a file
      if(!reportFile.exists())
      {
        reportFile.createNewFile();
        // Create required column names in the report file
        reportFile.write('"Test Suite","Test Case","Test Step","Step Type","Step Status",'
                        +'"Result message","Execution Date"');
      }
/* ------------------------------------------------------------------------------- */
// 5. Inserting data in the file
      // Iterate over all the test steps results
  for(stepResult in testRunner.getResults())
  {
    // Retrieve Test Suite name
   def testSuite = testRunner.testCase.testSuite.name;
   // Retrieve Test Case name
   def testCase = testRunner.testCase.name;
   // Retrieve Test Step
   def testStep = stepResult.getTestStep();
   // Retrieve Test Step name
   def testStepName = testStep.name
   // Retrieve Test Step type
   def type = testStep.config.type
   // Retrieve Test Step status
   def status = stepResult.getStatus()

   // Creating new line in report file
   reportFile.append('\n');

   // Write all the necessary information in the file
   reportFile.append('"' + testSuite + '",');
   reportFile.append('"' + testCase + '",');
   reportFile.append('"' + testStepName + '",');
   reportFile.append('"' + type + '",');
   reportFile.append('"' + status + '",');

   // Retrieve the test result messages
   reportFile.append('"');
   for(resMessage in stepResult.getMessages())
   {
     // Write messages and separate multiple messages by new line
     reportFile.append('Message:' + resMessage + '\n');
   }
   reportFile.append('",');

   //Write executionDate in the file
   reportFile.append('"' + executionDate + '",');
/* ------------------------------------------------------------------------------- */
// 6. Extract the request and response and save it to external file
      // Verify if the test step type is request: SOAP project or restrequest: REST project
        if((type=="request").or(type=="restrequest"))
        {
          // Extract the request from the test step
          def extRequest = testStep.properties["Request"].value;    

      // Create a file in the reports folder and write the request
      // Naming convention: request_TestSuiteName_TestCaseName_TestStepName.txt
      def requestFile=subfolderPath1+"/request_"+testSuite+"_"+testCase+"_"+testStepName+".txt";
      def rqfile = new File(requestFile);
      rqfile.write(extRequest, "UTF-8");

      // Extract the response from the test step
      def extResponse = stepResult.getResponseContent();    

      // Create a file in the reports folder and write the response
      // Naming convention: response_TestSuiteName_TestCaseName_TestStepName.txt
      def responseFile=subfolderPath1+"/response_"+testSuite+"_"+testCase+"_"+testStepName+".txt";
      def rsfile = new File(responseFile);
      rsfile.write(extResponse, "UTF-8");
     }
   }
 }
catch(exc)
{
   log.error("Exception happened: " + exc.toString());
}</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>